- Web servers and web applications often provide a large attack surface and are very high value during a penetration test. Let's discover how to attack these servers.
- ## [[Gobuster]]
	- After discovering a web application, it is always worth checking if we can uncover any hidden files or directories. We can use tools such as [[ffuf]] or GoBuster in order to achieve this.
	- ### Directory/File Enumeration
		- GoBuster is a versatile tool for DNS, vhost, and directory brute-forcing. This tool can also enumerate public #AWS S3 buckets. Let's focus on brute forcing with the switch `dir` using the `dirb common.txt` wordlist.
		- ```sh
		  gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt
		  ```
		- ```output
		  ===============================================================
		  Gobuster v3.0.1
		  by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
		  ===============================================================
		  [+] Url:            http://10.10.10.121/
		  [+] Threads:        10
		  [+] Wordlist:       /usr/share/dirb/wordlists/common.txt
		  [+] Status codes:   200,204,301,302,307,401,403
		  [+] User Agent:     gobuster/3.0.1
		  [+] Timeout:        10s
		  ===============================================================
		  2020/12/11 21:47:25 Starting gobuster
		  ===============================================================
		  /.hta (Status: 403)
		  /.htpasswd (Status: 403)
		  /.htaccess (Status: 403)
		  /index.php (Status: 200)
		  /server-status (Status: 403)
		  /wordpress (Status: 301)
		  ===============================================================
		  2020/12/11 21:47:46 Finished
		  ===============================================================
		  ```
		- An HTTP code of 200 reveals that the resource's request was successful while a 403 indicates permission denied. 301 indicates a redirect.
		- Our scan completed successfully and indicated a WordPress installation at /wordpress. WordPress is the most commonly used Content Management System and has a large potential attack surface. Visiting `http://10.10.10.121/wordpress` in a browser will reveal WordPress is in set up mode which will allow us to gain Remote Code Execution on the server.
	- ### DNS Subdomain Enumeration
		- There may also be essential resources hosted on subdomains, such as admin panels or applications with additional functionality that could be exploited. We can use GoBuster to enumerate available subdomains using the `dns` flag to specify DNS mode.
		- The SecLists Github repo, which contains many useful lists for fuzzing and exploitation, can be obtained via
		- ```sh
		  git clone https://github.com/danielmiessler/SecLists
		  ```
		- ```sh
		  sudo apt install seclists -y
		  ```
		- Next, we need to add a DNS Server such as 1.1.1.1 to /etc/resolv.conf. We will target a fictional domain, ```inlanefreight.com```, a fictional freight and logistics company
		- ```sh
		  gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt
		  ```
		- ```output
		  ===============================================================
		  Gobuster v3.0.1
		  by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)
		  ===============================================================
		  [+] Domain:     inlanefreight.com
		  [+] Threads:    10
		  [+] Timeout:    1s
		  [+] Wordlist:   /usr/share/SecLists/Discovery/DNS/namelist.txt
		  ===============================================================
		  2020/12/17 23:08:55 Starting gobuster
		  ===============================================================
		  Found: blog.inlanefreight.com
		  Found: customer.inlanefreight.com
		  Found: my.inlanefreight.com
		  Found: ns1.inlanefreight.com
		  Found: ns2.inlanefreight.com
		  Found: ns3.inlanefreight.com
		  ===============================================================
		  2020/12/17 23:10:34 Finished
		  ===============================================================
		  ```
		- This reveals several interesting subdomains which could be examined further.
	- ## Web Enumeration Tips
		- ### Banner Grabbing ( #bannergrab ) / Web Server Headers
			- In the [[Basic Tools]] and [[Service Scanning]] sections, we discussed banner grabbing for general purposes. Web service headers provide a good picture of what is hosted on a web server.
			- Web service headers can reveal what application framework is in use, the authentication options, and whether the server is missing essential security updates or has been misconfigured.
			- We can use `cURL` to retrieve server header information from the command line. ( #cURL )
			- ```sh
			  curl -IL https://www.inlanefreight.com
			  ```
			- ```output
			  HTTP/1.1 200 OK
			  Date: Fri, 18 Dec 2020 22:24:05 GMT
			  Server: Apache/2.4.29 (Ubuntu)
			  Link: <https://www.inlanefreight.com/index.php/wp-json/>; rel="https://api.w.org/"
			  Link: <https://www.inlanefreight.com/>; rel=shortlink
			  Content-Type: text/html; charset=UTF-8
			  ```
			- Another handy tool is EyeWitness which can be used to take screenshots of web applications, fingerprint them, and identify default credentials.
		- ### [[Whatweb]]
			- We can extract the version of web servers, supporting frameworks, and applications using the cli tool whatweb. This can be helpful for pinpointing vulnerabilities.
			- ```sh
			  whatweb 10.10.10.121
			  ```
			- ```output
			  http://10.10.10.121 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], Email[license@php.net], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.121], Title[PHP 7.4.3 - phpinfo()]
			  ```
			- Whatweb is a handy tool and contains a lot of functionality to automate web application enumeration across a network.
			- ```sh
			  whatweb --no-errors 10.10.10.0/24
			  ```
			- ```output
			  http://10.10.10.11 [200 OK] Country[RESERVED][ZZ], HTTPServer[nginx/1.14.1], IP[10.10.10.11], PoweredBy[Red,nginx], Title[Test Page for the Nginx HTTP Server on Red Hat Enterprise Linux], nginx[1.14.1]
			  http://10.10.10.100 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.100], Title[File Sharing Service]
			  http://10.10.10.121 [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], Email[license@php.net], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.121], Title[PHP 7.4.3 - phpinfo()]
			  http://10.10.10.247 [200 OK] Bootstrap, Country[RESERVED][ZZ], Email[contact@cross-fit.htb], Frame, HTML5, HTTPServer[OpenBSD httpd], IP[10.10.10.247], JQuery[3.3.1], PHP[7.4.12], Script, Title[Fine Wines], X-Powered-By[PHP/7.4.12], X-UA-Compatible[ie=edge]
			  ```
		- ### Certificates
			- SSL/TLS certificates can also provide valuable information if HTTPS is in use. We can pull the certificates of https://10.10.10.121/ and potentially conduct a phishing attack if necessary.
		- ### Robots.txt
			- It is common for websites to contain a `robots.txt`. The purpose is to instruct search engines which resources can and cannot be accessed for inexing. The robots.txt can provide valuable information such as the location of private files and admin pages.
			- ```
			  User-agent: *
			  Disallow: /private
			  Disallow: /uploaded_files
			  ```
			- In this case, https://10.10.10.121/private yields a HTB admin login page.
		- ### Source Code
			- It is also worth checking source code for any web pages we come accross. We can hit `CTRL + U` to bring up the source code window in a browser. Here, a developer has left a comment revealing a test credential
			- ```html
			  <!--test account: egre55 / password1-->
			  <html>
			    <head>
			      <meta charset="utf-8">
			      <meta name="viewport" content="width=device-width, initial-scale=1">
			      
			      <title>Admin Login</title>
			      <link href="https://fonts.googleapis.com/css?family=Nunito:200,600" rel="stylesheet">
			  ```